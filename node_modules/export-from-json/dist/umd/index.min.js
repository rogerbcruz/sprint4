!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).exportFromJSON=t()}(this,function(){"use strict";function g(e){return"[object Array]"===Object.prototype.toString.call(e)}function O(e,t){if(!e)throw new Error(t)}function R(e){return Object.keys(e)}function U(t){return Object.keys(t).map(function(e){return[e,t[e]]})}function L(e,t,n){var r="."+t,t=new RegExp("(\\"+t+")?$");return n(e).replace(t,r)}function c(e){return"555xmlHello .  world!".trim().replace(/^([0-9,;]|(xml))+/,""),e.replace(/[^_a-zA-Z 0-9:\-\.]/g,"").replace(/^([ 0-9-:\-\.]|(xml))+/i,"").replace(/ +/g,"-")}function u(e){return Array(e+1).join(" ")}function i(e){return e.replace(/([<>&])/g,function(e,t){switch(t){case"<":return"&lt;";case">":return"&gt;";case"&":return"&amp;";default:return""}})}function C(e,t,n,r){void 0===n&&(n="download");t=function(e,t,n){switch(t){case"txt":var r="text/plain;charset=utf-8";return n?URL.createObjectURL(new Blob([e],{type:r})):"data:,"+r+encodeURIComponent(e);case"css":r="text/css;charset=utf-8";return n?URL.createObjectURL(new Blob([e],{type:r})):"data:,"+r+encodeURIComponent(e);case"html":r="text/html;charset=utf-8";return n?URL.createObjectURL(new Blob([e],{type:r})):"data:,"+r+encodeURIComponent(e);case"json":r="text/json;charset=utf-8";return n?URL.createObjectURL(new Blob([e],{type:r})):"data:,"+r+encodeURIComponent(e);case"csv":r="text/csv;charset=utf-8";return n?URL.createObjectURL(new Blob([e],{type:r})):"data:,"+r+encodeURIComponent(e);case"xls":r="text/application/vnd.ms-excel;charset=utf-8";return n?URL.createObjectURL(new Blob([e],{type:r})):"data:,"+r+encodeURIComponent(e);case"xml":r="text/application/xml;charset=utf-8";return n?URL.createObjectURL(new Blob([e],{type:r})):"data:,"+r+encodeURIComponent(e);default:return""}}(e,t,r=void 0===r?!0:r),r=document.createElement("a");r.href=t,r.download=n,r.setAttribute("style","visibility:hidden"),document.body.appendChild(r),r.dispatchEvent(new MouseEvent("click",{bubbles:!1,cancelable:!1,view:window})),document.body.removeChild(r)}var e,E=function(){return(E=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function N(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,a=n.call(e),c=[];try{for(;(void 0===t||0<t--)&&!(r=a.next()).done;)c.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=a.return)&&n.call(a)}finally{if(o)throw o.error}}return c}function I(a){return a.map(U).reduce(function(e,t,o){return t.reduce(function(e,t){var n=N(t,2),r=n[0],t=n[1],n=e[r]||Array.from({length:a.length}).map(function(e){return""});return n[o]=("string"!=typeof t?JSON.stringify(t):t)||"",e[r]=n,e},e)},Object.create(null))}function S(e,t){return(t=void 0===t?function(e){return e}:t)(U(e).map(function(e){e=N(e,2);return{fieldName:e[0],fieldValues:e[1]}}))}function B(e,t){return e.length?'<html>\n  <head>\n    <meta charset="UTF-8" />\n  </head >\n  <body>\n    '+(t=t=void 0===t?function(e){return e}:t,O(0<(e=e).length),"\n    <table>\n      <thead>\n        <tr><th><b>"+(t=S(I(e),t)).map(function(e){return e.fieldName}).join("</b></th><th><b>")+"</b></th></tr>\n      </thead>\n      <tbody>\n        <tr>"+t.map(function(e){return e.fieldValues}).map(function(e){return e.map(function(e){return"<td>"+e+"</td>"})}).reduce(function(e,n){return e.map(function(e,t){return""+e+n[t]})}).join("</tr>\n        <tr>")+"</tr>\n      </tbody>\n    </table>\n  ")+"\n  </body>\n</html >\n":""}function J(e){return'<?xml version="1.0" encoding="utf-8"?><!DOCTYPE base>\n'+function n(e,t,r,o){void 0===r&&(r="element");void 0===o&&(o=0);var a=c(t);var t=u(o);if(null==e)return t+"<"+a+" />";var e=g(e)?e.map(function(e){return n(e,r,r,o+2)}).join("\n"):"object"==typeof e?U(e).map(function(e){var t=N(e,2),e=t[0],t=t[1];return n(t,e,r,o+2)}).join("\n"):t+"  "+i(String(e));var a=t+"<"+a+">\n"+e+"\n"+t+"</"+a+">";return a}(e,"base")+"\n"}function t(e){var t=e.data,n=e.fileName,r=void 0===n?"download":n,o=e.extension,a=e.fileNameFormatter,c=void 0===a?function(e){return e.replace(/\s+/,"_")}:a,u=e.fields,i=e.exportType,l=void 0===i?"txt":i,n=e.replacer,a=void 0===n?null:n,i=e.space,n=void 0===i?4:i,i=e.processor,f=void 0===i?C:i,i=e.withBOM,d=void 0!==i&&i,i=e.delimiter,s=void 0===i?",":i,e=e.beforeTableEncode,p=void 0===e?function(e){return e}:e,m="Invalid export data. Please provide an array of object",v="Can't export unknown data type "+l+".",h="Can't export string data to "+l+".";if("string"==typeof t)switch(l){case"txt":case"css":case"html":return f(t,l,L(r,null!=o?o:l,c));default:throw new Error(h)}var b,y,x=function(e){if(!e||g(e)&&!e.length||!g(e)&&!R(e).length)return function(e){return e};var r=g(e)?e.reduce(function(e,t){return E(E({},e),((e={})[t]=t,e))},Object.create(null)):e;return function(e){return g(e)?e.map(function(e){return U(e).reduce(function(e,t){var n=N(t,2),t=n[0],n=n[1];return t in r&&(e[r[t]]=n),e},Object.create(null))}).filter(function(e){return R(e).length}):U(e).reduce(function(e,t){var n=N(t,2),t=n[0],n=n[1];return t in r&&(e[r[t]]=n),e},Object.create(null))}}(u)(function(e){try{return"string"==typeof e?JSON.parse(e):e}catch(e){throw new Error("Invalid export data. Please provide a valid JSON")}}(t)),w=function(e,t,n){void 0===t&&(t=null);try{return JSON.stringify(e,t,n)}catch(e){throw new Error("Invalid export data. Please provide valid JSON object")}}(x,a,n);switch(l){case"txt":case"css":case"html":return f(w,l,L(r,null!=o?o:l,c));case"json":return f(w,l,L(r,null!=o?o:"json",c));case"csv":O(g(x),m);var j=(void 0===(y=s)&&(y=","),void 0===(j=p)&&(j=function(e){return e}),(b=x).length?(j=S(I(b),j)).map(function(e){return e.fieldName}).join(y)+"\r\n"+j.map(function(e){return e.fieldValues}).map(function(e){return e.map(function(e){return'"'+e.replace(/\"/g,'""')+'"'})}).reduce(function(e,n){return e.map(function(e,t){return""+e+y+n[t]})}).join("\r\n"):"");return f(d?"\ufeff"+j:j,l,L(r,null!=o?o:"csv",c));case"xls":return O(g(x),m),f(B(x,p),l,L(r,null!=o?o:"xls",c));case"xml":return f(J(x),l,L(r,null!=o?o:"xml",c));default:throw new Error(v)}}return(e=t=t||{}).types={txt:"txt",css:"css",html:"html",json:"json",csv:"csv",xls:"xls",xml:"xml"},e.processors={downloadFile:C},t});
